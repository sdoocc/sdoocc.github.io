(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{809:function(e,t,a){"use strict";var n=a(4),l=a(0),r=a.n(l),c=a(1),i=a.n(c),o=a(174),s={children:i.a.node},u=function(e){return r.a.createElement(o.a,Object(n.a)({group:!0},e))};u.propTypes=s,t.a=u},856:function(e,t,a){"use strict";a.r(t);var n=a(22),l=a(23),r=a(24),c=a(25),i=a(11),o=a(0),s=a.n(o),u=a(85),d=a(87),p=a(138),m=a(228),h=a(69),E=a(70),f=a(44),g=a(41),v=a(38),y=a(45),k=a(14),b=a(42),O=a(83),N=a(137),D=a(51),A=a(71),S=a(67),x=a(68),I=a(84),P=a(809),T=a(173),j=a(172),w=a(29),C=a(72),R=a(10),z=(a(3),a(94));function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(i.a)(e);if(t){var l=Object(i.a)(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return Object(c.a)(this,a)}}o.Component,a(175);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(i.a)(e);if(t){var l=Object(i.a)(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return Object(c.a)(this,a)}}var B=function(e){Object(r.a)(a,e);var t=M(a);function a(e){var l;return Object(n.a)(this,a),(l=t.call(this,e)).state={dropdownOpen:!1,page:1,channelName:"\u9009\u62e9\u8fc7\u6ee4\u7c7b\u578b",list:[],channel:-1,exchange:null,action:!1,working:!1},l.filterOptions=["\u8d44\u6e90ID","\u4e0b\u8f7d\u8d26\u6237","\u6d41\u91cf\u77ff\u5de5\u8d26\u6237"],l.fee="0.01",l.amount="0.1",l.deadline="5",l}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(R.loadLocalAccount)();e&&e.secret&&(this.secret=e.secret,this.account=e),this.loadAll()}},{key:"toggle",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"loadAll",value:function(){var e=this;if(this.account){Object(R.sign)(this.account.secret,this.account.pk);var t={action:"rtoken",type:"list",page:this.state.page,size:20,filterType:this.state.channel,query:this.state.query},a=Object(R.getShareHost)()+"/bshop";Object(R.postSafe)(a,t,function(t,a){if(t&&a&&a.list){var n=a.list;e.setState({list:n})}})}}},{key:"updateExchangeStatus",value:function(e){}},{key:"doTransfer",value:function(){var e=this,t=this.account.pk,a={action:"transaction",type:"transfer",amount:this.amount,fee:this.fee,dealine:this.deadline,pk:t,recipientPk:this.state.rtoken.pk,recipientId:this.state.rtoken.miner};this.setState({working:!0}),Object(w.doBShopTransaction)(this.secret,a,function(t,a){t&&a.ok?(e.setState({dialogMsg:"(\u6210\u529f),\u7b49\u5f85\u673a\u5668\u4eba\u9a8c\u8bc1",tranferOk:!0}),e.updateExchangeStatus(a.transactionId)):e.setState({dialogMsg:"(\u5931\u8d25)"})}.bind(this))}},{key:"upateFilterValue",value:function(e){if(e&&e.target){var t=e.target.value;this.setState({query:t})}}},{key:"prePage",value:function(){this.state.page--,this.loadAll()}},{key:"nextPage",value:function(){this.state.page++,this.loadAll()}},{key:"setFilter",value:function(e){this.setState({channel:e,channelName:this.filterOptions[e]})}},{key:"renderFilterOptions",value:function(){var e=this;return this.filterOptions.map(function(t,a){return s.a.createElement(D.a,{onClick:function(t){e.setFilter(a)}},t)})}},{key:"toggleActionDialog",value:function(){this.setState({action:!this.state.action,dialogMsg:"",tranferOk:!1})}},{key:"renderActionDialog",value:function(){return this.state.rtoken?s.a.createElement(A.a,{isOpen:this.state.action,toggle:this.toggleActionDialog.bind(this),className:"modal-info "+this.props.className},s.a.createElement(S.a,{toggle:this.toggleActionDialog.bind(this)},"\u5956\u52b1\u6d41\u91cf\u77ff\u5de5"),s.a.createElement(x.a,null,s.a.createElement(b.a,null,s.a.createElement("div",{className:"controls"},s.a.createElement(f.a,{className:"input-prepend"},s.a.createElement(g.a,{addonType:"prepend"},s.a.createElement(v.a,null,"\u6211\u7684\u8d26\u6237:")),s.a.createElement(y.a,{id:"appendedPrependedInput",size:"16",type:"text",value:this.account.rsId})))),s.a.createElement(b.a,null,s.a.createElement("div",{className:"controls"},s.a.createElement(f.a,{className:"input-prepend"},s.a.createElement(g.a,{addonType:"prepend"},s.a.createElement(v.a,null,"\u77ff\u5de5ID:")),s.a.createElement(y.a,{id:"appendedPrependedInput",size:"16",type:"text",value:this.state.rtoken.miner})))),s.a.createElement(b.a,null,s.a.createElement("div",{className:"controls"},s.a.createElement(f.a,{className:"input-prepend"},s.a.createElement(g.a,{addonType:"prepend"},s.a.createElement(v.a,null,"\u77ff\u5de5\u516c\u94a5:")),s.a.createElement(y.a,{id:"appendedPrependedInput",size:"16",type:"text",value:this.state.rtoken.pk})))),s.a.createElement(b.a,null,s.a.createElement("div",{className:"controls"},s.a.createElement(f.a,{className:"input-prepend"},s.a.createElement(g.a,{addonType:"prepend"},s.a.createElement(v.a,null,"\u79ef\u5206\u6570\u91cf:")),s.a.createElement(y.a,{id:"appendedPrependedInput",size:"16",type:"text",onChange:this.updateAmount.bind(this)})))),s.a.createElement(b.a,null,s.a.createElement("div",{className:"controls"},s.a.createElement(f.a,{className:"input-prepend"},s.a.createElement(g.a,{addonType:"prepend"},s.a.createElement(v.a,null,"\u673a\u5668\u4eba\u8d39:")),s.a.createElement(y.a,{id:"appendedPrependedInput",size:"16",type:"text",onChange:this.updateFee.bind(this),placeholder:"\u6700\u5c110.01\u79ef\u5206"})))),s.a.createElement(b.a,null,s.a.createElement("div",{className:"controls"},s.a.createElement(f.a,{className:"input-prepend"},s.a.createElement(g.a,{addonType:"prepend"},s.a.createElement(v.a,null,"\u6709\u6548\u671f:")),s.a.createElement(y.a,{id:"appendedPrependedInput",size:"16",onChange:this.updateDeadline.bind(this),type:"text",placeholder:"\u9ed8\u8ba45\u5206\u949f"}),s.a.createElement(g.a,{addonType:"append"},s.a.createElement(v.a,null,"\u5206\u949f"))))),this.renderdialogMsg()),s.a.createElement(I.a,null,s.a.createElement(k.a,{color:"danger",onClick:this.toggleActionDialog.bind(this)},"\u53d6\u6d88"),this.renderPayBtn())):null}},{key:"renderPayBtn",value:function(){return this.state.tranferOk||this.state.working?null:s.a.createElement(k.a,{color:"danger",onClick:this.doTransfer.bind(this)},"\u53d1\u9001\u79ef\u5206")}},{key:"renderdialogMsg",value:function(){return this.state.dialogMsg?s.a.createElement(O.a,null,this.state.dialogMsg):null}},{key:"updateAmount",value:function(e){if(e&&e.target){var t=e.target.value;t&&t.length>0&&(this.amount=t)}}},{key:"updateFee",value:function(e){if(e&&e.target){var t=e.target.value;t&&t.length>0&&(this.fee=t)}}},{key:"updateDeadline",value:function(e){if(e&&e.target){var t=e.target.value;this.deadline=t}}},{key:"renderActionButtons",value:function(e){var t=this;return s.a.createElement("td",null,s.a.createElement(k.a,{size:"sm",onClick:function(a){t.setState({rtoken:e}),t.toggleActionDialog()}.bind(this)},"\u5956\u52b1\u77ff\u5de5"))}},{key:"renderExchangelist",value:function(){var e=this,t=this.state.list;return t?t.map(function(t){var a=new Date;a.setTime(t.time);var n=a.toLocaleString();a.setTime(t.tokenTime);var l=a.toLocaleString(),r=t.id;return s.a.createElement("tr",null,s.a.createElement("td",null,r),s.a.createElement("td",null,n),s.a.createElement("td",null,l),s.a.createElement("td",null,t.resId," "),s.a.createElement("td",null,s.a.createElement(C.a,{rsId:t.miner})),s.a.createElement("td",null,s.a.createElement(C.a,{rsId:t.downloader})),s.a.createElement("td",null,t.ip),s.a.createElement("td",null,t.status),s.a.createElement("td",null,t.note),e.renderActionButtons(t))}):null}},{key:"render",value:function(){var e=this;return s.a.createElement(u.a,null,s.a.createElement(d.a,null,s.a.createElement(k.a,{color:"primary",onClick:function(t){return e.loadAll()}},s.a.createElement("i",{className:"fa fa-search"}),"\u663e\u793a\u5168\u90e8"),s.a.createElement(f.a,null,s.a.createElement(P.a,{isOpen:this.state.dropdownOpen,toggle:function(){e.toggle()}},s.a.createElement(T.a,{caret:!0},this.state.channelName),s.a.createElement(j.a,null,this.renderFilterOptions())),s.a.createElement(y.a,{placeholder:"\u8f93\u5165\u641c\u7d22\u53c2\u6570",onChange:this.upateFilterValue.bind(this)}),s.a.createElement(k.a,{color:"primary",onClick:function(t){return e.loadAll()}},s.a.createElement("i",{className:"fa fa-search"}),"\xa0")),s.a.createElement(p.a,{hover:!0,bordered:!0,striped:!0,responsive:!0,size:"sm"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"ID"),s.a.createElement("th",null,"\u4e0a\u4f20\u65f6\u95f4"),s.a.createElement("th",null,"Token\u65f6\u95f4"),s.a.createElement("th",null,"\u8d44\u6e90ID"),s.a.createElement("th",null,"\u6d41\u91cf\u77ff\u5de5"),s.a.createElement("th",null,"\u4e0b\u8f7d\u8d26\u6237"),s.a.createElement("th",null,"Ip\u5730\u5740"),s.a.createElement("th",null,"\u72b6\u6001"),s.a.createElement("th",null,"\u5907\u6ce8"),s.a.createElement("th",null,"\u64cd\u4f5c"))),s.a.createElement("tbody",null,this.renderExchangelist(),this.renderActionDialog())),s.a.createElement("nav",null,s.a.createElement(m.a,null,s.a.createElement(h.a,null,s.a.createElement(E.a,{previous:!0,tag:"button",onClick:function(t){e.prePage()}},"Prev(\u4e0a\u4e00\u9875")),s.a.createElement(h.a,{active:!0},s.a.createElement(E.a,{tag:"button"},this.state.page)),s.a.createElement(h.a,null,s.a.createElement(E.a,{next:!0,tag:"button",onClick:function(t){e.nextPage()}},"Next(\u4e0b\u4e00\u9875")))),s.a.createElement(N.a,{color:"danger"},s.a.createElement("small",null,"\u8d26\u6237\u91d1\u989d\u5927\u4e8e100\u7684\u8d26\u6237\u624d\u6709\u6743\u9650\u67e5\u770b\u7528\u6237\u786e\u8ba4\u4fe1\u606f\u5217\u8868."))))}}]),a}(o.Component);t.default=B}}]);